<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puzzle</title>
    <!-- Style Sheet-->
    <link rel="icon" href="/img/homepage/logoweb.ico" type="images/x-ico" />
    <link rel="stylesheet" id="bootstrap-css-css" href="/css/back/bootstrap5152.css" type="text/css" media="all">
    <link rel="stylesheet" id="responsive-css-css" href="/css/back/responsive5152.css" type="text/css" media="all">
    <link rel="stylesheet" id="pretty-photo-css-css" href="/css/back/prettyPhotoaeb9.css" type="text/css" media="all">
    <link rel="stylesheet" id="main-css-css" href="/css/back/main5152.css" type="text/css" media="all">
    <script src="https://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
    <style>
        body{
            background: white !important;
        }
    </style>
</head>

<body>
    <div class="header-wrapper">
        <header>
            <div class="container">
                <div class="logo-container">
                    <a href="/"><span class="tag-line">知识图谱-Puzzle</span> </a>
                </div>
                <!-- Start of Main Navigation -->
                <nav class="main-nav">
                    <div class="menu-top-menu-container">
                        <ul id="menu-top-menu" class="clearfix">
                            <li><a href="/display">可视化</a></li>
                            <li><a href="/3dnodes">3D视图</a></li>
                            <li><a href="/robot">智能问答</a></li>
                            <li><a href="#about">论文</a></li>
                            <li><a href="#contact">联系</a></li>
                        </ul>
                    </div>
                </nav>
            </div>
        </header>
    </div>
    <!-- End of Header -->


    <main role="main" style="text-align: center">

        <h2>分布式系统情况监控</h2>
        <div class="table-responsive" style="width: 70%; margin:0 auto">
            <table class="table table-striped table-sm">
                <thead>
                <tr>
                    <th>编号</th>
                    <th>机器代号</th>
                    <th>CPU占有率</th>
                    <th>内存占有率</th>
                    <th>状态</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>1</td>
                    <td>Lorem</td>
                    <td>ipsum</td>
                    <td>dolor</td>
                    <td>sit</td>
                </tr>

                </tbody>
            </table>
        </div>

        <h2 class="h2">CPU 使用率</h2>
        <div id="container" style="height: 300px; width: 70%; margin:0 auto"></div>
        <button onclick="cpu_update()">add</button>
        <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
        <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>
        <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
        <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
        <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
        <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
        <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
        <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/simplex.js"></script>
        <script type="text/javascript">
            var i = 0;
            var max_size = 30;

            function cpu_update(){
                 $.ajax({
                     url: "/cpu",
                     async: false,
                     success: function(response) {
                         date.push('');
                         data.push(response[0]["cpu"]);
                         console.log(data);
                         if (date.length > max_size) {
                             data = data.slice(-max_size);
                             date = date.slice(-max_size);
                         }
                         myChart.setOption({
                             xAxis: {
                                 data: date
                             },
                             series: [{
                                 data: data
                             }]
                         });
                     }
                 });
            }

            var dom = document.getElementById("container");
            var myChart = echarts.init(dom);
            var app = {};
            option = null;
            var date = [];
            var data = [];

            for(var s=0;s<max_size;s++){
                date.push('');
                data.push(0);
            }

            init(data, date);

            function init(data, date) {
                option = {
                    tooltip: {
                        trigger: 'axis',
                        position: function(pt) {
                            return [pt[0], '10%'];
                        }
                    },
                    xAxis: {
                        type: 'category',
                        boundaryGap: false,
                        data: date
                    },
                    yAxis: {
                        type: 'value',
                        boundaryGap: [0, '50%']
                    },
                    series: [{
                        name: '模拟数据',
                        type: 'line',
                        smooth: true,
                        symbol: 'none',
                        sampling: 'average',
                        itemStyle: {
                            color: 'rgb(255, 70, 131)'
                        },
                        areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                                offset: 0,
                                color: 'rgb(255, 158, 68)'
                            }, {
                                offset: 1,
                                color: 'rgb(255, 70, 131)'
                            }])
                        },
                        data: data
                    }]
                };;
                if (option && typeof option === "object") {
                    myChart.setOption(option, true);
                }
                window.setInterval(cpu_update, 1000);
            }
        </script>


    </main>

</body>


</html>